import { useGameStore } from "./store/gameStore";
import { StartScreen } from "./components/StartScreen";
import { ResultPhase } from "./components/ResultPhase";
import { GrafanaPanel } from "./components/GrafanaPanel";

export default function App() {
    const phase = useGameStore((state) => state.phase);

    const showGrafana = phase !== "start";

    const Placeholder = ({ title }: { title: string }) => (
        <div className="p-6">
            <div className="text-2xl font-semibold">{title}</div>
            <div className="mt-2 text-sm text-slate-400">
                当前阶段：<span className="font-mono">{String(phase)}</span>
            </div>
            <div className="mt-6 rounded-xl border border-slate-800 bg-slate-900/40 p-4 text-sm text-slate-300">
                这个阶段组件当前无法作为 JSX 渲染（组件导出返回了 void）。
                先确保页面不黑屏，下一步我们会修复 CardDrawPhase / RacePhase 的返回值。
            </div>
        </div>
    );

    const renderPhaseContent = () => {
        switch (phase) {
            case "start":
                return <StartScreen />;
            case "card-draw":
                return <Placeholder title="Card Draw Phase（待修复）" />;
            case "race":
                return <Placeholder title="Race Phase（待修复）" />;
            case "result":
                return <ResultPhase />;
            default:
                return <Placeholder title="Loading…" />;
        }
    };

    return (
        <div className="min-h-screen bg-slate-950 text-slate-50">
            <div className="mx-auto flex min-h-screen max-w-[1400px]">
                <main className="flex-1 overflow-hidden">{renderPhaseContent()}</main>

                {showGrafana ? (
                    <aside className="hidden w-[420px] shrink-0 border-l border-slate-800 bg-slate-950/60 lg:block">
                        <GrafanaPanel />
                    </aside>
                ) : null}
            </div>
        </div>
    );
}


